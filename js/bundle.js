"use strict";function metamaskTransaction(){"undefined"!=typeof web3?(window.web3=new Web3(web3.currentProvider),web3.eth.getAccounts(function(e,t){e?console.error(e):web3.eth.sendTransaction({from:web3.eth.accounts[0],to:conf.web3.btmballot_contract.address,value:"2000000000000000000"},function(e,t){e?console.error(e):console.log(t)})})):console.log("No web3? You should consider trying MetaMask!")}var express=require("express"),bodyParser=require("body-parser"),Web3=require("web3"),contract=require("truffle-contract"),provider=require("./libs/web3provider"),path=require("path"),cjson=require("cjson"),conf=cjson.load(["./libs/config.json","./libs/config.local.json"],!0),abi=cjson.load(conf.web3.btmballot_contract.abi),web3=new Web3(new Web3.providers.HttpProvider(conf.web3.provider)),VotingContract=contract(abi);VotingContract.setProvider(new Web3.providers.HttpProvider(conf.web3.provider));var app=express();app.use(bodyParser.urlencoded({extended:!1})),app.post("/user/register",function(e,t){var n=e.body.firstName,a=e.body.lastName,i=e.body.myEmail,o=e.body.identity,s=e.body.myAddress,p=e.body.telephone,y=e.body.voterAddress;VotingContract.deployed().then(function(e){return e.registerVoters(n,a,i,o,s,p,{from:y,gas:2e6})}).then(function(e){console.log("Successfully Registered as"+n+a)})["catch"](function(e){console.log("ERROR! "+e.message),console.log("You cannot Register Twice or Edit your details")});var u=e.body.myEmail,m=(e.body.firstName,require("nodemailer"));m.createTestAccount(function(e,t){var a=m.createTransport({host:"smtp.gmail.com",port:587,secure:!1,auth:{user:"kelvin@blockchaintmhub.io",pass:"BigBrain_70"}}),i="kelvin@blockchaintmhub.io",o={from:i,to:u,subject:"Successfully Registered to the Voting System",text:"Hello"+n+"You Have Successfully Registered to BTM Voting Dapp",html:'<b>"Hello User," + "You Have Successfully Registered to BTM Voting Dapp"</b>'};a.sendMail(o,function(e,t){return e?console.log(e):(console.log("Message sent: %s",t.messageId),void console.log("Preview URL: %s",m.getTestMessageUrl(t)))})}),t.send("Successfully Registered as a Voter ")}),app.post("/admin/register/party",function(e,t){var n=e.body.partyName,a=e.body.partyID;VotingContract.deployed().then(function(e){return e.registerParty(a,n,{from:web3.eth.accounts[0],gas:2e6})}).then(function(e){console.log("Party Registered")})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("successfully registered the party")}),app.post("/admin/election",function(e,t){var n=e.body.electionAgenda,a=e.body.electionDate;VotingContract.deployed().then(function(e){return e.createElection(n,a,{from:web3.eth.accounts[0],gas:2e6})}).then(function(e){console.log("Election Created")})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Success")}),app.post("/admin/election/start",function(e,t){var n=e.body.inputelectionID;VotingContract.deployed().then(function(e){return e.startElection(n,{from:web3.eth.accounts[0],gas:2e6})}).then(function(e){console.log("Election"+n+"started")})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Started")}),app.post("/user/election/vote",function(e,t){var n=e.body.selectedParty,a=e.body.voterAddress;VotingContract.deployed().then(function(e){return e.vote(n,{from:a,gas:2e6})}).then(function(e){console.log("Vote for "+n+"cast")}),t.send("Vote cast")}),app.post("/admin/election/stop",function(e,t){var n=e.body.inputelectionID;VotingContract.deployed().then(function(e){return e.stopElection(n,{from:web3.eth.accounts[0],gas:2e6})}).then(function(e){console.log("Election"+n+"stopped")})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Stopped")}),app.post("/auth/voter",function(e,t){var n=e.body.voterVerAddress;VotingContract.deployed().then(function(e){return e.giveRightToVote(n,{from:web3.eth.accounts[0],gas:2e6})}).then(function(e){console.log("Voter"+n+"Given Vote Privileges")})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Authenticated")}),app.post("/admin/election/switchAdmin",function(e,t){var n=e.body.adminAddress;VotingContract.deployed().then(function(e){return e.switchRegistar(n)}).then(function(e){console.log("The new Admin is"+n)})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Switched")}),app.post("/user/delegatevote",function(e,t){var n=(e.body.inputDelegate,e.body.inputDelegateAddress);VotingContract.deployed().then(function(e){return e.delegate(n)}).then(function(e){console.log("You Delagate your vote to"+n),console.log("Your Reason is"+n)})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Successfully Delegated")}),app.post("/user/unlockAccount",function(e,t){var n,a=e.body.address,i=e.body.passphrase;VotingContract.deployed().then(function(e){n=e,web3.personal.unlockAccount(a,i)}).then(function(e){console.log("Unlocked")})["catch"](function(e){console.log("ERROR! "+e.message)}),t.send("Successfully Unlocked")}),app.get("/election/results",function(e,t){var n,a,i,o="0x5f08269175826fba28298f359dbfc58935a45bdb",s=[{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proposals",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"chairperson",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"voterDetails",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"electionLookUp",outputs:[{name:"electionID",type:"uint256"},{name:"electionName",type:"string"},{name:"startDateTime",type:"string"},{name:"endElection",type:"bool"},{name:"startElection",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numVoters",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"activePoll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"partyReg",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numElections",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"checkVoter",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"voters",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numParties",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"voterer",type:"address"},{indexed:!1,name:"partyNamed",type:"string"},{indexed:!1,name:"thePartyRef",type:"uint256"}],name:"Votes",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"sur_name",type:"string"},{indexed:!1,name:"last_Name",type:"string"},{indexed:!1,name:"e_mail",type:"string"},{indexed:!1,name:"ID_No",type:"uint256"},{indexed:!1,name:"address_d",type:"string"},{indexed:!1,name:"Tele_phone",type:"uint256"},{indexed:!1,name:"myAddress",type:"address"}],name:"voterRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"partyRef",type:"uint256"},{indexed:!1,name:"party_Name",type:"string"},{indexed:!1,name:"votesFor",type:"uint256"}],name:"PartyRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"election_ID",type:"uint256"},{indexed:!1,name:"purpose",type:"string"},{indexed:!1,name:"dateTime",type:"string"},{indexed:!1,name:"hasEnded",type:"bool"}],name:"electionCreation",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"theVoter",type:"address"},{indexed:!1,name:"granted",type:"bool"}],name:"GrantedVote",type:"event"},{constant:!1,inputs:[{name:"newAdmin",type:"address"}],name:"switchRegistar",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"voter",type:"address"}],name:"giveRightToVote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"}],name:"delegate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"myVote",type:"uint256"}],name:"vote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"winningProposal",outputs:[{name:"winningProposal",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"desiredIndex",type:"uint256"}],name:"talliedPartyName",outputs:[{name:"tallyPartyName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyIndex",type:"uint256"}],name:"talliedPartyVotes",outputs:[{name:"gatheredVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyRank",type:"uint256"}],name:"talliedPartyRank",outputs:[{name:"talliedRank",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerName",outputs:[{name:"winnerName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerVotes",outputs:[{name:"totalVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"Mysurname",type:"string"},{name:"MylastName",type:"string"},{name:"Myemail",type:"string"},{name:"myIDNo",type:"uint256"},{name:"myAddress",type:"string"},{name:"myTelephone",type:"uint256"}],name:"registerVoters",outputs:[{name:"",type:"address"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"partyIDNo",type:"uint256"},{name:"partyNamed",type:"string"}],name:"registerParty",outputs:[{name:"",type:"bool"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ItsPurpose",type:"string"},{name:"EdateTime",type:"string"}],name:"createElection",outputs:[{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"electionStartID",type:"uint256"}],name:"startElection",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"stopElectionID",type:"uint256"}],name:"stopElection",outputs:[{name:"",type:"bool"},{name:"",type:"bool"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"partyIndex",type:"uint256"}],name:"voteResults",outputs:[{name:"",type:"uint256"},{name:"",type:"string"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"regVoter",type:"address"}],name:"getBoolVote",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"}],p=web3.eth.contract(s).at(o),y=p.numParties(),u=p.winnerVotes(),m=0;for(counter=1;counter<y;counter++)if(p.talliedPartyVotes(counter)<u){var r=counter,l=p.talliedPartyName(counter),d=p.talliedPartyVotes(counter);m=r}p.talliedPartyVotes(2)!=u?(n=p.talliedPartyName(1),a=p.talliedPartyVotes(1),i=1):p.talliedPartyVotes(1)!=u?(n=p.talliedPartyName(3),a=p.talliedPartyVotes(3),i=3):p.talliedPartyVotes(3)!=u&&(n=p.talliedPartyName(2),a=p.talliedPartyVotes(2),i=2);var c={partyRank:r,partyName:l,votesCast:d,lastPartyName:n,lastPartyVotes:a,lastPartyIndex:i};t.send(c)}),app.get("/winningparty",function(e,t){var n="0x5f08269175826fba28298f359dbfc58935a45bdb",a=[{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proposals",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"chairperson",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"voterDetails",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"electionLookUp",outputs:[{name:"electionID",type:"uint256"},{name:"electionName",type:"string"},{name:"startDateTime",type:"string"},{name:"endElection",type:"bool"},{name:"startElection",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numVoters",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"activePoll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"partyReg",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numElections",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"checkVoter",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"voters",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numParties",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"voterer",type:"address"},{indexed:!1,name:"partyNamed",type:"string"},{indexed:!1,name:"thePartyRef",type:"uint256"}],name:"Votes",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"sur_name",type:"string"},{indexed:!1,name:"last_Name",type:"string"},{indexed:!1,name:"e_mail",type:"string"},{indexed:!1,name:"ID_No",type:"uint256"},{indexed:!1,name:"address_d",type:"string"},{indexed:!1,name:"Tele_phone",type:"uint256"},{indexed:!1,name:"myAddress",type:"address"}],name:"voterRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"partyRef",type:"uint256"},{indexed:!1,name:"party_Name",type:"string"},{indexed:!1,name:"votesFor",type:"uint256"}],name:"PartyRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"election_ID",type:"uint256"},{indexed:!1,name:"purpose",type:"string"},{indexed:!1,name:"dateTime",type:"string"},{indexed:!1,name:"hasEnded",type:"bool"}],name:"electionCreation",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"theVoter",type:"address"},{indexed:!1,name:"granted",type:"bool"}],name:"GrantedVote",type:"event"},{constant:!1,inputs:[{name:"newAdmin",type:"address"}],name:"switchRegistar",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"voter",type:"address"}],name:"giveRightToVote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"}],name:"delegate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"myVote",type:"uint256"}],name:"vote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"winningProposal",outputs:[{name:"winningProposal",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"desiredIndex",type:"uint256"}],name:"talliedPartyName",outputs:[{name:"tallyPartyName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyIndex",type:"uint256"}],name:"talliedPartyVotes",outputs:[{name:"gatheredVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyRank",type:"uint256"}],name:"talliedPartyRank",outputs:[{name:"talliedRank",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerName",outputs:[{name:"winnerName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerVotes",outputs:[{name:"totalVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"Mysurname",type:"string"},{name:"MylastName",type:"string"},{name:"Myemail",type:"string"},{name:"myIDNo",type:"uint256"},{name:"myAddress",type:"string"},{name:"myTelephone",type:"uint256"}],name:"registerVoters",outputs:[{name:"",type:"address"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"partyIDNo",type:"uint256"},{name:"partyNamed",type:"string"}],name:"registerParty",outputs:[{name:"",type:"bool"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ItsPurpose",type:"string"},{name:"EdateTime",type:"string"}],name:"createElection",outputs:[{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"electionStartID",type:"uint256"}],name:"startElection",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"stopElectionID",type:"uint256"}],name:"stopElection",outputs:[{name:"",type:"bool"},{name:"",type:"bool"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"partyIndex",type:"uint256"}],name:"voteResults",outputs:[{name:"",type:"uint256"},{name:"",type:"string"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"regVoter",type:"address"}],name:"getBoolVote",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"}],i=web3.eth.contract(a).at(n),o=i.winnerName(),s=i.winnerVotes().toNumber(),p=i.winningProposal().toNumber(),y={winnerName:o,winnerVotes:s,winnerIndex:p};t.send(y)}),app.get("/elections",function(e,t){var n="0x5f08269175826fba28298f359dbfc58935a45bdb",a=[{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proposals",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"chairperson",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"voterDetails",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"electionLookUp",outputs:[{name:"electionID",type:"uint256"},{name:"electionName",type:"string"},{name:"startDateTime",type:"string"},{name:"endElection",type:"bool"},{name:"startElection",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numVoters",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"activePoll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"partyReg",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numElections",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"checkVoter",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"voters",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numParties",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"voterer",type:"address"},{indexed:!1,name:"partyNamed",type:"string"},{indexed:!1,name:"thePartyRef",type:"uint256"}],name:"Votes",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"sur_name",type:"string"},{indexed:!1,name:"last_Name",type:"string"},{indexed:!1,name:"e_mail",type:"string"},{indexed:!1,name:"ID_No",type:"uint256"},{indexed:!1,name:"address_d",type:"string"},{indexed:!1,name:"Tele_phone",type:"uint256"},{indexed:!1,name:"myAddress",type:"address"}],name:"voterRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"partyRef",type:"uint256"},{indexed:!1,name:"party_Name",type:"string"},{indexed:!1,name:"votesFor",type:"uint256"}],name:"PartyRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"election_ID",type:"uint256"},{indexed:!1,name:"purpose",type:"string"},{indexed:!1,name:"dateTime",type:"string"},{indexed:!1,name:"hasEnded",type:"bool"}],name:"electionCreation",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"theVoter",type:"address"},{indexed:!1,name:"granted",type:"bool"}],name:"GrantedVote",type:"event"},{constant:!1,inputs:[{name:"newAdmin",type:"address"}],name:"switchRegistar",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"voter",type:"address"}],name:"giveRightToVote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"to",type:"address"}],name:"delegate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"myVote",type:"uint256"}],name:"vote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"winningProposal",outputs:[{name:"winningProposal",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"desiredIndex",type:"uint256"}],name:"talliedPartyName",outputs:[{name:"tallyPartyName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyIndex",type:"uint256"}],name:"talliedPartyVotes",outputs:[{name:"gatheredVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyRank",type:"uint256"}],name:"talliedPartyRank",outputs:[{name:"talliedRank",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerName",outputs:[{name:"winnerName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerVotes",outputs:[{name:"totalVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"Mysurname",type:"string"},{name:"MylastName",type:"string"},{name:"Myemail",type:"string"},{name:"myIDNo",type:"uint256"},{name:"myAddress",type:"string"},{name:"myTelephone",type:"uint256"}],name:"registerVoters",outputs:[{name:"",type:"address"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"partyIDNo",type:"uint256"},{name:"partyNamed",type:"string"}],name:"registerParty",outputs:[{name:"",type:"bool"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ItsPurpose",type:"string"},{name:"EdateTime",type:"string"}],name:"createElection",outputs:[{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"electionStartID",type:"uint256"}],name:"startElection",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"stopElectionID",type:"uint256"}],name:"stopElection",outputs:[{name:"",type:"bool"},{name:"",type:"bool"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"partyIndex",type:"uint256"}],name:"voteResults",outputs:[{name:"",type:"uint256"},{name:"",type:"string"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"regVoter",type:"address"}],name:"getBoolVote",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"}],i=web3.eth.contract(a).at(n),o=i.electionCreation({},{fromBlock:0,toBlock:"latest"});o.watch(function(e,n){console.log(n),t.send(n)})}),app.get("/voters",function(e,t){var n="0x5f08269175826fba28298f359dbfc58935a45bdb",a=[{constant:!0,inputs:[{name:"",type:"uint256"}],name:"proposals",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"chairperson",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"voterDetails",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"electionLookUp",outputs:[{name:"electionID",type:"uint256"},{name:"electionName",type:"string"},{name:"startDateTime",type:"string"},{name:"endElection",type:"bool"},{name:"startElection",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numVoters",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"activePoll",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"uint256"}],name:"partyReg",outputs:[{name:"partyNumber",type:"uint256"},{name:"name",type:"string"},{name:"voteCount",type:"uint256"},{name:"legit",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numElections",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"checkVoter",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"",type:"address"}],name:"voters",outputs:[{name:"weight",type:"uint256"},{name:"voted",type:"bool"},{name:"delegate",type:"address"},{name:"vote",type:"uint256"},{name:"surname",type:"string"},{name:"lastName",type:"string"},{name:"email",type:"string"},{name:"IDNo",type:"uint256"},{name:"Address",type:"string"},{name:"Telephone",type:"uint256"},{name:"isRegistered",type:"bool"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"numParties",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{inputs:[],payable:!1,stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,name:"voterer",type:"address"},{indexed:!1,name:"partyNamed",type:"string"},{indexed:!1,name:"thePartyRef",type:"uint256"}],name:"Votes",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"sur_name",type:"string"},{indexed:!1,name:"last_Name",type:"string"},{indexed:!1,name:"e_mail",type:"string"},{indexed:!1,name:"ID_No",type:"uint256"},{indexed:!1,name:"address_d",type:"string"},{indexed:!1,name:"Tele_phone",type:"uint256"},{indexed:!1,name:"myAddress",type:"address"}],name:"voterRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"partyRef",type:"uint256"},{indexed:!1,name:"party_Name",type:"string"},{indexed:!1,name:"votesFor",type:"uint256"}],name:"PartyRegistered",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"election_ID",type:"uint256"},{indexed:!1,name:"purpose",type:"string"},{indexed:!1,name:"dateTime",type:"string"},{indexed:!1,name:"hasEnded",type:"bool"}],name:"electionCreation",type:"event"},{anonymous:!1,inputs:[{indexed:!1,name:"theVoter",type:"address"},{indexed:!1,name:"granted",type:"bool"}],name:"GrantedVote",type:"event"},{constant:!1,inputs:[{name:"newAdmin",type:"address"}],name:"switchRegistar",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"voter",type:"address"}],name:"giveRightToVote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,
inputs:[{name:"to",type:"address"}],name:"delegate",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"myVote",type:"uint256"}],name:"vote",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"winningProposal",outputs:[{name:"winningProposal",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"desiredIndex",type:"uint256"}],name:"talliedPartyName",outputs:[{name:"tallyPartyName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyIndex",type:"uint256"}],name:"talliedPartyVotes",outputs:[{name:"gatheredVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"tallyRank",type:"uint256"}],name:"talliedPartyRank",outputs:[{name:"talliedRank",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerName",outputs:[{name:"winnerName",type:"string"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"winnerVotes",outputs:[{name:"totalVotes",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"Mysurname",type:"string"},{name:"MylastName",type:"string"},{name:"Myemail",type:"string"},{name:"myIDNo",type:"uint256"},{name:"myAddress",type:"string"},{name:"myTelephone",type:"uint256"}],name:"registerVoters",outputs:[{name:"",type:"address"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"partyIDNo",type:"uint256"},{name:"partyNamed",type:"string"}],name:"registerParty",outputs:[{name:"",type:"bool"},{name:"",type:"uint256"},{name:"",type:"uint256"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"ItsPurpose",type:"string"},{name:"EdateTime",type:"string"}],name:"createElection",outputs:[{name:"",type:"uint256"},{name:"",type:"uint256"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"electionStartID",type:"uint256"}],name:"startElection",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"stopElectionID",type:"uint256"}],name:"stopElection",outputs:[{name:"",type:"bool"},{name:"",type:"bool"},{name:"",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"partyIndex",type:"uint256"}],name:"voteResults",outputs:[{name:"",type:"uint256"},{name:"",type:"string"},{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"regVoter",type:"address"}],name:"getBoolVote",outputs:[{name:"",type:"bool"}],payable:!1,stateMutability:"view",type:"function"}],i=web3.eth.contract(a).at(n),o=i.voterRegistered({},{fromBlock:0,toBlock:"latest"}),s="";o.watch(function(e,n){s=JSON.stringify(n),t.send(s)})}),app.listen(8e3,function(e){e||console.log("Server is Running on port 8000")});var express=require("express"),bodyParser=require("body-parser"),Web3=require("web3"),contract=require("truffle-contract"),conf=require("./libs/config"),provider=require("./libs/web3provider"),path=require("path"),cjson=require("cjson"),conf=cjson.load(["./libs/config.json","./libs/config.local.json"],!0),abi=cjson.load(conf.web3.btmballot_contract.abi),web3=new Web3(new Web3.providers.HttpProvider(conf.web3.provider)),VotingContract=contract(abi);VotingContract.setProvider(new Web3.providers.HttpProvider(conf.web3.provider));var app=express();app.use(bodyParser.urlencoded({extended:!1}));var test=function(e,t){return"Test: "+e+" and "+t};console.log(test("Success","Bro")),$(document).bind("change",function(e){$(e.target).is(":invalid")?$(e.target).addClass("invalid-input"):$(e.target).removeClass("invalid-input")}),module.exports=app,module.exports=VotingContract;